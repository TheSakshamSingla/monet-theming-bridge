# Monet Theming Bridge API Reference

This document provides detailed information about the JavaScript API for the Monet Theming Bridge.

## Table of Contents

- [MonetBridge Class](#monetbridge-class)
  - [Constructor](#constructor)
  - [Methods](#methods)
  - [Properties](#properties)
- [Color Format](#color-format)
- [CSS Variables](#css-variables)
- [Events](#events)
- [Error Handling](#error-handling)
- [Examples](#examples)

## MonetBridge Class

The `MonetBridge` class is the main entry point for interacting with the Monet theming system.

### Constructor

```javascript
const monetBridge = new MonetBridge(options);
```

#### Options

| Option | Type | Default | Description |
|--------|------|---------|-------------|
| `colorFilePath` | String | `/data/local/tmp/monet_colors.json` | Path to the JSON file containing Monet colors |
| `refreshInterval` | Number | `30000` | Interval in milliseconds to check for color updates (0 to disable) |
| `onColorsLoaded` | Function | `null` | Callback function called when colors are loaded |
| `onError` | Function | `null` | Callback function called when an error occurs |
| `fallbackColors` | Object | Material You palette | Fallback colors to use if Monet colors can't be loaded |
| `applyToCssVars` | Boolean | `false` | Whether to automatically apply colors to CSS variables |

### Methods

#### init()

Initializes the Monet Bridge and loads colors.

```javascript
const success = await monetBridge.init();
```

**Returns**: Promise<Boolean> - Resolves to `true` if initialization was successful, `false` otherwise.

#### loadColors()

Loads Monet colors from the file generated by the native module.

```javascript
const colors = await monetBridge.loadColors();
```

**Returns**: Promise<Object> - Resolves to an object containing the loaded colors.

#### getColor(name)

Gets a specific Monet color by name.

```javascript
const primaryColor = monetBridge.getColor('accent1_700');
```

**Parameters**:
- `name` (String): The name of the color to get

**Returns**: String - The color value in hex format (e.g., `#6750A4`), or `null` if not found.

#### getAllColors()

Gets all available Monet colors.

```javascript
const allColors = monetBridge.getAllColors();
```

**Returns**: Object - An object containing all available colors.

#### applyColorsToCssVariables(prefix)

Applies Monet colors to CSS variables.

```javascript
monetBridge.applyColorsToCssVariables('--monet-');
```

**Parameters**:
- `prefix` (String, optional): Prefix for CSS variable names. Default: `--monet-`

#### destroy()

Cleans up resources used by the Monet Bridge.

```javascript
monetBridge.destroy();
```

### Properties

#### colors

An object containing the currently loaded Monet colors.

```javascript
const colors = monetBridge.colors;
```

#### isLoading

A boolean indicating whether colors are currently being loaded.

```javascript
const isLoading = monetBridge.isLoading;
```

## Color Format

Colors are provided in hexadecimal format (e.g., `#6750A4`). The following color names are available:

| Color Name | Description |
|------------|-------------|
| `accent1_10` | Primary accent color (lightest) |
| `accent1_50` | Primary accent color |
| `accent1_100` | Primary accent color |
| `accent1_200` | Primary accent color |
| `accent1_300` | Primary accent color |
| `accent1_400` | Primary accent color |
| `accent1_500` | Primary accent color |
| `accent1_600` | Primary accent color |
| `accent1_700` | Primary accent color (Material You primary) |
| `accent1_800` | Primary accent color |
| `accent1_900` | Primary accent color (darkest) |
| `accent2_10` | Secondary accent color (lightest) |
| `accent2_50` | Secondary accent color |
| `accent2_100` | Secondary accent color |
| ... | Additional colors |

## CSS Variables

When using `applyToCssVars`, the following CSS variables are created:

```css
:root {
  --monet-accent1_10: #...;
  --monet-accent1_50: #...;
  --monet-accent1_100: #...;
  /* ... more color variables ... */
  
  /* Semantic color mapping */
  --monet-primary: var(--monet-accent1_700);
  --monet-primary-container: var(--monet-accent1_100);
  --monet-on-primary: #FFFFFF;
  /* ... more semantic variables ... */
}
```

## Events

### onColorsLoaded

Called when colors are successfully loaded.

```javascript
const monetBridge = new MonetBridge({
  onColorsLoaded: (colors) => {
    console.log('Colors loaded:', colors);
  }
});
```

### onError

Called when an error occurs while loading colors.

```javascript
const monetBridge = new MonetBridge({
  onError: (error) => {
    console.error('Error loading colors:', error);
  }
});
```

## Error Handling

The Monet Bridge handles errors gracefully by falling back to default colors when the actual Monet colors cannot be loaded. You can provide custom fallback colors or handle errors manually using the `onError` callback.

```javascript
try {
  await monetBridge.init();
} catch (error) {
  console.error('Failed to initialize Monet Bridge:', error);
  // Handle error
}
```

## Examples

### Basic Usage

```javascript
// Initialize with default options
const monetBridge = new MonetBridge();
await monetBridge.init();

// Get primary color
const primaryColor = monetBridge.getColor('accent1_700');
document.getElementById('my-button').style.backgroundColor = primaryColor;
```

### Advanced Usage

```javascript
// Initialize with custom options
const monetBridge = new MonetBridge({
  refreshInterval: 60000, // Check for updates every minute
  applyToCssVars: true,   // Automatically apply to CSS variables
  onColorsLoaded: (colors) => {
    // Update UI elements
    document.body.classList.add('colors-loaded');
    updateTheme(colors);
  },
  onError: (error) => {
    console.error('Error loading Monet colors:', error);
    document.body.classList.add('using-fallback-colors');
  },
  fallbackColors: {
    // Custom fallback colors
    "accent1_700": "#1E88E5", // Blue primary color
    "accent1_200": "#90CAF9"
  }
});

// Initialize
const success = await monetBridge.init();

// Clean up when done
window.addEventListener('beforeunload', () => {
  monetBridge.destroy();
});
```

### Using with CSS Utilities

```html
<!-- Include the CSS utilities -->
<link rel="stylesheet" href="path/to/monet-theme.css">

<!-- Use the utility classes -->
<button class="monet-button">Primary Button</button>
<div class="monet-card">
  <h2 class="monet-text-primary">Card Title</h2>
  <p>Card content</p>
</div>
```
